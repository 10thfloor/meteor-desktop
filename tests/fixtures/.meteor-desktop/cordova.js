/**
 * This is based on:
 * https://github.com/meteor/cordova-plugin-meteor-webapp/blob/master/www/webapp_local_server.js
 */

WebAppLocalServer = {
    _onNewVersionReady: null,

    startupDidComplete: function startupDidComplete(callback) {
        // TODO: implement fallback startegy
        console.log('startupDidComplete() fired');
    },

    checkForUpdates: function checkForUpdates(callback) {
        Electron.send('autoupdateModule', 'checkForUpdates');
    },

    onNewVersionReady: function onNewVersionReady(callback) {
        this._onNewVersionReady = callback;
    },

    onError: function onError(callback) {
        console.log('onError called');
    }
};

Electron.on('autoupdateModule', 'error', function error(event, args) {
    console.log('received');
    console.error(args);
});

Electron.on('autoupdateModule', 'onNewVersionReady', function onNewVersionReady(event, args) {
    console.log('new version ready', args);
    if (WebAppLocalServer._onNewVersionReady) {
        WebAppLocalServer._onNewVersionReady(args);
    }
});

// Set the reference, so that the desktop side will be able to communicate with us asap.
Electron.send('dummyModule', 'setRendererReference');
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlbXBsYXRlcy9jb3Jkb3ZhLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBS0Esb0JBQW9CO0FBQ2hCLHdCQUFvQixJQURKOztBQUdoQix3QkFBb0IsU0FBUyxrQkFBVCxDQUE0QixRQUE1QixFQUFzQzs7QUFFdEQsZ0JBQVEsR0FBUixDQUFZLDRCQUFaO0FBQ0gsS0FOZTs7QUFRaEIscUJBQWlCLFNBQVMsZUFBVCxDQUF5QixRQUF6QixFQUFtQztBQUNoRCxpQkFBUyxJQUFULENBQWMsa0JBQWQsRUFBa0MsaUJBQWxDO0FBQ0gsS0FWZTs7QUFZaEIsdUJBQW1CLFNBQVMsaUJBQVQsQ0FBMkIsUUFBM0IsRUFBcUM7QUFDcEQsYUFBSyxrQkFBTCxHQUEwQixRQUExQjtBQUNILEtBZGU7O0FBZ0JoQixhQUFTLFNBQVMsT0FBVCxDQUFpQixRQUFqQixFQUEyQjtBQUNoQyxnQkFBUSxHQUFSLENBQVksZ0JBQVo7QUFDSDtBQWxCZSxDQUFwQjs7QUFxQkEsU0FBUyxFQUFULENBQVksa0JBQVosRUFBZ0MsT0FBaEMsRUFBeUMsU0FBUyxLQUFULENBQWUsS0FBZixFQUFzQixJQUF0QixFQUE0QjtBQUNqRSxZQUFRLEdBQVIsQ0FBWSxVQUFaO0FBQ0EsWUFBUSxLQUFSLENBQWMsSUFBZDtBQUNILENBSEQ7O0FBS0EsU0FBUyxFQUFULENBQVksa0JBQVosRUFBZ0MsbUJBQWhDLEVBQXFELFNBQVMsaUJBQVQsQ0FBMkIsS0FBM0IsRUFBa0MsSUFBbEMsRUFBd0M7QUFDekYsWUFBUSxHQUFSLENBQVksbUJBQVosRUFBaUMsSUFBakM7QUFDQSxRQUFJLGtCQUFrQixrQkFBdEIsRUFBMEM7QUFDdEMsMEJBQWtCLGtCQUFsQixDQUFxQyxJQUFyQztBQUNIO0FBQ0osQ0FMRDs7O0FBUUEsU0FBUyxJQUFULENBQWMsYUFBZCxFQUE2QixzQkFBN0IiLCJmaWxlIjoidGVtcGxhdGVzL2NvcmRvdmEuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogVGhpcyBpcyBiYXNlZCBvbjpcclxuICogaHR0cHM6Ly9naXRodWIuY29tL21ldGVvci9jb3Jkb3ZhLXBsdWdpbi1tZXRlb3Itd2ViYXBwL2Jsb2IvbWFzdGVyL3d3dy93ZWJhcHBfbG9jYWxfc2VydmVyLmpzXHJcbiAqL1xyXG5cclxuV2ViQXBwTG9jYWxTZXJ2ZXIgPSB7XHJcbiAgICBfb25OZXdWZXJzaW9uUmVhZHk6IG51bGwsXHJcblxyXG4gICAgc3RhcnR1cERpZENvbXBsZXRlOiBmdW5jdGlvbiBzdGFydHVwRGlkQ29tcGxldGUoY2FsbGJhY2spIHtcclxuICAgICAgICAvLyBUT0RPOiBpbXBsZW1lbnQgZmFsbGJhY2sgc3RhcnRlZ3lcclxuICAgICAgICBjb25zb2xlLmxvZygnc3RhcnR1cERpZENvbXBsZXRlKCkgZmlyZWQnKTtcclxuICAgIH0sXHJcblxyXG4gICAgY2hlY2tGb3JVcGRhdGVzOiBmdW5jdGlvbiBjaGVja0ZvclVwZGF0ZXMoY2FsbGJhY2spIHtcclxuICAgICAgICBFbGVjdHJvbi5zZW5kKCdhdXRvdXBkYXRlTW9kdWxlJywgJ2NoZWNrRm9yVXBkYXRlcycpO1xyXG4gICAgfSxcclxuXHJcbiAgICBvbk5ld1ZlcnNpb25SZWFkeTogZnVuY3Rpb24gb25OZXdWZXJzaW9uUmVhZHkoY2FsbGJhY2spIHtcclxuICAgICAgICB0aGlzLl9vbk5ld1ZlcnNpb25SZWFkeSA9IGNhbGxiYWNrO1xyXG4gICAgfSxcclxuXHJcbiAgICBvbkVycm9yOiBmdW5jdGlvbiBvbkVycm9yKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ29uRXJyb3IgY2FsbGVkJyk7XHJcbiAgICB9XHJcbn07XHJcblxyXG5FbGVjdHJvbi5vbignYXV0b3VwZGF0ZU1vZHVsZScsICdlcnJvcicsIGZ1bmN0aW9uIGVycm9yKGV2ZW50LCBhcmdzKSB7XHJcbiAgICBjb25zb2xlLmxvZygncmVjZWl2ZWQnKTtcclxuICAgIGNvbnNvbGUuZXJyb3IoYXJncyk7XHJcbn0pO1xyXG5cclxuRWxlY3Ryb24ub24oJ2F1dG91cGRhdGVNb2R1bGUnLCAnb25OZXdWZXJzaW9uUmVhZHknLCBmdW5jdGlvbiBvbk5ld1ZlcnNpb25SZWFkeShldmVudCwgYXJncykge1xyXG4gICAgY29uc29sZS5sb2coJ25ldyB2ZXJzaW9uIHJlYWR5JywgYXJncyk7XHJcbiAgICBpZiAoV2ViQXBwTG9jYWxTZXJ2ZXIuX29uTmV3VmVyc2lvblJlYWR5KSB7XHJcbiAgICAgICAgV2ViQXBwTG9jYWxTZXJ2ZXIuX29uTmV3VmVyc2lvblJlYWR5KGFyZ3MpO1xyXG4gICAgfVxyXG59KTtcclxuXHJcbi8vIFNldCB0aGUgcmVmZXJlbmNlLCBzbyB0aGF0IHRoZSBkZXNrdG9wIHNpZGUgd2lsbCBiZSBhYmxlIHRvIGNvbW11bmljYXRlIHdpdGggdXMgYXNhcC5cclxuRWxlY3Ryb24uc2VuZCgnZHVtbXlNb2R1bGUnLCAnc2V0UmVuZGVyZXJSZWZlcmVuY2UnKTtcclxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
